/**
*  RT
*  unified client-side real-time communication using (xhr) polling / bosh / (web)sockets
*
*  @version: 0.1.0
*  https://github.com/foo123/RT
*
**/
!function(e,t,n){"use strict";"object"==typeof exports?module.exports=n():(e[t]=n())&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}(this,"RT",function(){"use strict";function e(t){t=t||{};var r=(t.type||"default").toLowerCase();return e.Client.Impl[n](r)?new e.Client.Impl[r](t):new e.Client(t)}var t="prototype",n="hasOwnProperty",r=Object.keys,i=Object[t].toString,o=String[t].trim?function(e){return e.trim()}:function(e){return e.replace(/^\s+|\s+$/g,"")};return e.VERSION="0.1.0",e.Const={CRLF:"\r\n",CRLF_RE:/(\r\n)|\r|\n/g,COOKIE_RE:/([^=]+)(?:=(.*))?/},e.Util={String:{trim:o},Base64:{encode:btoa,decode:atob},Json:{encode:JSON.stringify,decode:JSON.parse},Url:{create:function(t){if(!t)return"";var n,o,l,s,u,c,f,a,d,p=[],C=r(t),h=C.length,g=e.Util.Url.encode;for(s=0,n=h>s?[[o=C[s++],t[o]]]:[];n.length;){if(u=n.shift(),o=u[0],l=u[1],d=i.call(l),"[object Array]"===d)for(o+="[]",c=0,f=l.length;f>c;c++)n.unshift([o,l[c]]);else if("[object Object]"===d)for(a=r(l),c=0,f=a.length;f>c;c++)n.unshift([o+"["+a[c]+"]",l[a[c]]]);else p.push(g(o)+"="+g(l));!n.length&&h>s&&n.unshift([o=C[s++],t[o]])}return p.join("&")},rawencode:function(e){return encodeURIComponent(""+e).split("!").join("%21").split("'").join("%27").split("(").join("%28").split(")").join("%29").split("*").join("%2A")},rawdecode:function(e){return decodeURIComponent(""+e)},encode:function(t){return e.Util.Url.rawencode(t).split("%20").join("+")},decode:function(t){return e.Util.Url.rawdecode((""+t).split("+").join("%20"))}},Cookie:{create:function(e,t,n,r,i,o,l){var s=arguments.length;return{name:s>0?e:"",value:s>1?t:"",domain:s>2?n:"",path:s>3?r:"/",expires:s>4?i:new Date(Date.now()+31536e6),secure:s>5?!!o:!1,httponly:s>6?!!l:!1}},encode:function(e){if(e&&e.name){var t=String(e.name)+"="+String(e.value);return t+="; Domain="+String(e.domain),t+="; Path="+String(e.path),t+="; Expires="+String(e.expires),e.secure&&(t+="; Secure"),e.httponly&&(t+="; HttpOnly"),t}},decode:function(t){var n,r,i,o,l=e.Util.Cookie.create(),s=e.Const.COOKIE_RE,u=(""+t).split("; ");if(null!=(n=u.shift().match(s))){for(l.name=n[1],l.value=n[2],i=0,o=u.length;o>i;i++)n=u[i].match(s),null!=n&&n.length&&(r=n[1].toLowerCase(),"undefined"!=typeof l[r]&&(l[r]="string"==typeof n[2]?n[2]:!0));return"string"==typeof l.expires&&(l.expires=new Date(l.expires)),l}}},Header:{encode:function(t,n){var o="";if(!t)return n?n:o;var l,s,u,c,f,a=r(t),d=e.Const.CRLF;if(n){for(s=0,u=a.length;u>s;s++)if(l=a[s],"[object Array]"===i.call(t[l]))for(c=0,f=t[l].length;f>c;c++)n.setRequestHeader(l,t[l][c]);else n.setRequestHeader(l,t[l]);return n}for(s=0,u=a.length;u>s;s++)if(l=a[s],"[object Array]"===i.call(t[l]))for(c=0,f=t[l].length;f>c;c++)o+=d+String(t[l][c]);else o+=d+String(t[l]);return o},decode:function(t,n){var r,i,l,s,u={},c=null,f=e.Const.CRLF;if(t)for(n=!0===n,t=t.split(f),i=0,l=t.length;l>i;i++)s=t[i],r=s.split(":"),r.length>1?(c=o(r.shift()),n&&(c=c.toLowerCase()),u[c]=r.join(":")):c&&(u[c]+=f+r[0]);return u}}},e.Client=function l(t){var n=this;return n instanceof l?(n._config=t,n._event={},void(n.status=e.Client.CREATED)):new l(t)},e.Client.Impl={},e.Client.OPENED=2,e.Client.CLOSED=4,e.Client.PENDING=8,e.Client.CREATED=1,e.Client.DESTROYED=0,e.Client[t]={constructor:e.Client,status:e.Client.CREATED,_config:null,_event:null,dispose:function(){var t=this;return t.status=e.Client.DESTROYED,t._config=null,t._event=null,t},addEventListener:function(e,t){var r=this;return e&&t?(r._event[n](e)?r._event[e].push(t):r._event[e]=[t],r):r},removeEventListener:function(e,t){var r=this;if(!e||!r._event[n](e))return r;if(null==t)delete r._event[e];else{for(var i=r._event[e],o=i.length-1;o>=0;o--)i[o]===t&&t.splice(o,1);i.length||delete r._event[e]}return r},trigger:function(e,t){var r=this;if(!e||!r._event[n](e))return r;var i,o=r._event[e].slice(),l=o.length;for(i=0;l>i;i++)o[i](t);return r},open:function(){},close:function(){},send:function(){},listen:function(){}},e.Client[t].on=e.Client[t].addEventListener,e.Client[t].off=e.Client[t].removeEventListener,e});