/**
*  RT
*  unified client-side real-time communication using (xhr) polling / bosh / (web)sockets
*  RT WebSocket Client (w/ websocket shim)
*
*  @version: 0.1.0
*  https://github.com/foo123/RT
*
**/
!function(e,t){"use strict";"object"==typeof exports?t(require("./RT.js")):t(e.RT)&&"function"==typeof define&&define.amd&&define(function(){return e.RT})}(this,function(e){"use strict";function t(e){var t,n,i=document.getElementsByTagName("scripts"),s=i[i.length-1].src.split("/").slice(0,-1).join("/"),r=document.getElementsByTagName("head")[0];window.swfobject||(t=document.createElement("script"),t.setAttribute("type","text/javascript"),t.setAttribute("language","javascript"),t.setAttribute("src",s+"/lib/ws/swfobject.js"),r.appendChild(t)),window.WEB_SOCKET_SWF_LOCATION=s+"/lib/ws/WebSocketMain.swf",window.WEB_SOCKET_FORCE_FLASH=!1,window.WEB_SOCKET_DEBUG=!1,n=document.createElement("script"),n.setAttribute("type","text/javascript"),n.setAttribute("language","javascript"),n.onload=n.onreadystatechange=function(){("loaded"==n.readyState||"complete"==n.readyState)&&(n.onload=n.onreadystatechange=null,e&&e())},n.setAttribute("src",s+"/lib/ws/web_socket.js"),r.appendChild(n)}var n="prototype",i=(Object[n].toString,e.Client[n]),s=(e.Util,window.WebSocket||window.MozWebSocket||window.WebkitWebSocket);return s||t(function(){s=window.WebSocket}),e.Client.WS=function r(e){var t=this;return t instanceof r?(i.constructor.call(t,e),void(t.$ws$=null)):new r(e)},e.Client.Impl.ws=e.Client.Impl.websocket=e.Client.Impl["web-socket"]=e.Client.WS,e.Client.WS[n]=Object.create(i),e.Client.WS[n].constructor=e.Client.WS,e.Client.WS[n].$ws$=null,e.Client.WS[n].dispose=function(){var e=this;return e.$ws$=null,i.dispose.call(e)},e.Client.WS[n].abort=function(){var e=this,t=e.$ws$;return t&&s.OPEN===t.readyState&&t.close(),e.$ws$=null,e},e.Client.WS[n].close=function(){var e=this,t=e.$ws$;return t&&s.OPEN===t.readyState&&t.close(),e},e.Client.WS[n].send=function(e){var t=this,n=t.$ws$;return n&&s.OPEN===n.readyState&&n.send(String(e)),t},e.Client.WS[n].listen=function(){var e,t=this;return e=t.$ws$=new s(t.$cfg$.url),e.addEventListener("open",function(e){t.emit("open",e)}),e.addEventListener("close",function(e){t.emit("close",e)}),e.addEventListener("error",function(e){t.emit("error",e)}),e.addEventListener("message",function(e){t.emit("receive",e.data)}),t},e});